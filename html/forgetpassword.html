<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <script type="text/javascript" src="assets/js/phaser.min.js"></script>
  <script type="text/javascript" src="assets/js/CanvasInput.min.js"></script>
  <link href="assets/css/global.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="assets/js/jquery.min.js"></script>
  <link href='https://fonts.googleapis.com/css?family=Indie+Flower' rel='stylesheet' type='text/css'>
</head>
<body>
  <input type="text" id="email" class="inputbox1" style="left:380px;top:250px">
  
  <script>
    var game = new Phaser.Game(800, 600, Phaser.CANVAS, '', {
      preload: function () {
        game.load.image('background', 'assets/img/background1.png');
        game.load.image('input', 'assets/img/inputbox1.png', 20, 20);
        game.load.spritesheet('button','assets/buttons/button1.jpg',100,34);
        game.load.bitmapFont('chiller', 'assets/fonts/chiller.png', 'assets/fonts/chiller.xml');
      },

      create: function () {
        var background = game.add.sprite(0, 0, 'background');
        background.smoothed = true;
        background.height = game.height;
        background.width = game.width;

        var forgetText = game.add.bitmapText(280, 130, 'chiller', 'Forget Password', 70);
        var usernameText = game.add.bitmapText(290, 240, 'chiller', 'Email', 54);
        
        var cofirmButton = game.add.button(395, 320, 'button', do_forget, this, 1, 0, 2, 0);
        var confirmButtonText = game.add.bitmapText(415, 325, 'chiller', 'Confirm', 28);
      }
    });


    function do_forget() {
      var email = $("#email").val();
      console.log(email);
      var v_email = /^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(email);
      if (!v_email || !v_password) {
        alert("邮箱格式不正确");
        return;
      }

      $.ajax({
				url:"/api/user/forget",
			  type:"POST",
				contentType:'application/json',
				data:JSON.stringify(email),
				success: function(data,status){
				  alert("信息已发送至邮箱");
					console.log(data);
			  },
			  error: function(data,status){
				  alert("邮箱不存在");
					console.log(data);
				}
			});
    }
  </script>

</body>

</html>