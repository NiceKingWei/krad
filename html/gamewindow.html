<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <script type="text/javascript" src="assets/js/phaser.min.js"></script>
  <script type="text/javascript" src="assets/js/CanvasInput.min.js"></script>
  <link href="assets/css/global.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="assets/js/jquery.min.js"></script>
  <link href='https://fonts.googleapis.com/css?family=Indie+Flower' rel='stylesheet' type='text/css'>
  <style>
       #gamecontainer{ height:400px; width: 800px; margin: 0px 0px ;  outline: 1px solid rgb(11, 206, 212); overflow: auto;}
       #cardcontainer{ height:50px; width: 600px; margin: 0px 0px  ; outline: 0px solid rgb(11, 206, 212); overflow: auto ;}
</style>
</head>
<body>
    <div id="gamecontainer"></div>
    <div id="cardcontainer"></div>
  <script>
      var player_num=3;
      var player = new Array();
      var map = [{x:410,y:10},{x:410,y:60},{x:410,y:120},{x:410,y:180},{x:410,y:240},{x:410,y:290},{x:410,y:345},{x:340,y:420},
      {x:435,y:480},{x:456,y:535},{x:474,y:595},{x:490,y:650},{x:515,y:710},{x:540,y:765},{x:568,y:820},
      {x:350,y:865},{x:143,y:820},{x:164,y:765},{x:185,y:710},{x:202,y:650},{x:227,y:595},{x:248,y:535},{x:269,y:480}];
      
      var game = new Phaser.Game(780, 899, Phaser.CANVAS, 'gamecontainer', {
       preload: function () {
        game.load.image('gamebackground', 'assets/img/gamewindow/gamebackground.png');
        game.load.image('fighter1','assets/img/gamewindow/fighter1.png');
        game.load.image('fighter2','assets/img/gamewindow/fighter2.png');
        game.load.image('fighter3','assets/img/gamewindow/fighter3.png');
        game.load.image('fighter4','assets/img/gamewindow/fighter4.png');
        game.load.image('poisoner1','assets/img/gamewindow/poisoner1.png');
        game.load.image('poisoner2','assets/img/gamewindow/poisoner2.png');
        game.load.image('poisoner3','assets/img/gamewindow/poisoner3.png');
        game.load.image('poisoner4','assets/img/gamewindow/poisoner4.png');
      },

      create: function () {
       /* game.time.desiredFps = 60; */
        game.physics.startSystem(Phaser.Physics.P2JS);
        game.world.setBounds(0, 0,game.width, game.height);
        do_init(0);
        var background = game.add.sprite(0,0,'gamebackground');
        background.smoothed = true;
        background.height = game.height;
        background.width = game.width;
        game.world.setChildIndex(background,0); 
      },

     update: function () {
       for(var i = 0;i<player_num;i++){
        player[i].body.setZeroVelocity();
       }
      }
      });

    var card = new Phaser.Game(600, 50, Phaser.CANVAS, 'cardcontainer',{
      preload: function () {
        card.load.image('cardbackground','assets/img/inputbox1.png');
        card.load.spritesheet('button','assets/buttons/button1.png',100,34);
      },
      create: function () {
    var cardbackground = card.add.sprite(0,0,'cardbackground');
        cardbackground.smoothed = true;
        cardbackground.height = card.height;
        cardbackground.width = card.width;
    var movebutton = card.add.button(0,0 , 'button', do_poison ,this, 1, 0, 2, 0);
    var movebutton = card.add.button(100,0 , 'button', do_move ,this, 1, 0, 2, 0);
      },
    });
    function do_move(){
      mark=7;
      people=0;
      player[people].body.x=map[mark].x+people*20+(4-player_num)*10;
      player[people].body.y=map[mark].y;
    }
    function do_poison(people){
      people=2;
      var x = player[people].body.x;
      var y = player[people].body.y;
      player[people].kill();
      player[people] = game.add.sprite(x, y, 'poisoner'+(people+1).toString());
      player[people].anchor.x=0.5;
      player[people].anchor.y=0.5;
      game.physics.p2.enable(player[people]);
    }
    function do_init(init_location){
      for(var i=0;i<player_num;i++){
         player[i] = game.add.sprite(map[init_location].x+i*20+(4-player_num)*10,map[init_location].y,'fighter'+ (i+1).toString());
         player[i].anchor.x=0.5;
         player[i].anchor.y=0.5;
         game.physics.p2.enable(player[i]);
         player[i].body.fixedRotation = true;
      }
    }
</script>
</body>

</html>
