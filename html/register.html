<<<<<<< HEAD
<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <script type="text/javascript" src="assets/js/phaser.min.js"></script>
  <script type="text/javascript" src="assets/js/CanvasInput.min.js"></script>
  <link href="assets/css/global.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="assets/js/jquery.min.js"></script>
  <link href='https://fonts.googleapis.com/css?family=Indie+Flower' rel='stylesheet' type='text/css'>
</head>
<body>
  <input type="text" id="email" class="inputbox1" style="left:410px;top:110px">
  <input type="text" id="nickname" class="inputbox1" style="left:410px;top:170px">
  <input type="radio" id="gender1" name="gender" style="left:410px;top:220px" value="0" checked="checked">
  <input type="radio" id="gender2" name="gender" style="left:510px;top:220px" value="1">
  <input type="password" id="password" class="inputbox1" style="left:410px;top:270px">
  <input type="password" id="confirm" class="inputbox1" style="left:410px;top:330px">
  <select class="figureSelect">
      <option value="figure1">Figure1</option>
      <option value="figure2">Figure2</option>
      <option value="figure3">Figure3</option>
      <option value="figure4">Figure4</option>
    </select>
  

  <script>
    var game = new Phaser.Game(800, 600, Phaser.CANVAS, '', {
      preload: function () {
        game.load.image('background', 'assets/img/background1.png');
        game.load.image('input', 'assets/img/inputbox1.png', 20, 20);
        game.load.spritesheet('button','assets/buttons/buttontest.png',100,34);
        game.load.bitmapFont('chiller', 'assets/fonts/chiller.png', 'assets/fonts/chiller.xml');
      },

      create: function () {
        var background = game.add.sprite(0, 0, 'background');
        background.smoothed = true;
        background.height = game.height;
        background.width = game.width;

        var registerText = game.add.bitmapText(350, 15, 'chiller', 'Register', 70);
        var emailText = game.add.bitmapText(315, 75, 'chiller', 'Email', 54);
        var nicknameText = game.add.bitmapText(260, 130, 'chiller', 'Nickname', 54);
        var genderText = game.add.bitmapText(280,185,'chiller','Gender',54);
        var maleText = game.add.bitmapText(435,175,'chiller','male',54);
        var femaleText = game.add.bitmapText(530,175,'chiller','female',54);
        var passwordText = game.add.bitmapText(265,235,'chiller','Password',54);
        var confirmText = game.add.bitmapText(275,290,'chiller','Confirm',54);
        var avatarText = game.add.bitmapText(290,345,'chiller','Avatar',54);
   
        var confirmButton = game.add.button(400, 400, 'button', do_register, this, 1, 0, 2);
        var confirmButtonText = game.add.bitmapText(420, 405, 'chiller', 'Confirm', 28);

      }
    });

    function do_register() {
      var email = $("#email").val();
      var nickname = $("#nickname").val();
      var password = $("#password").val();
      var confirm = $("#confirm").val();
      var avatar = $("#avatar").val();
      var gender = $("input[name='gender']:checked").val();
      if(password!=confirm){
          alert("两次密码填写不一样");
          return;
      }
      var req = {
        'email': email,
        'nickname':nicknema,
        'password': password,
        'avatar':avatar,
        'gender':gender,
      };
      
      console.log(req);
      var v_email = /^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(email);
      var v_password = /[a-zA-Z0-9]{6,18}/.test(password);
      var v_nickname =/{};:'/.test(nickname);
      
      // todo: 判断图像地址
      if (!v_email || !v_password) {
        alert("邮箱格式或密码格式不正确");
        return;
      }
      if(v_nickname){
          alert("昵称含有非法字符");
          return;
      }
      
      $.ajax({
          url: "/api/session/register",
          type: "POST",
          contentType: 'application/json',
          data: JSON.stringify(rep),
          success: function (data, status) {
            alert("账号注册成功");
            console.log(data);
            window.location.href='hello.html';
          },
          error: function (data, status) {
            alert("账号注册失败");
            console.log(data);
          }
        });
    }
  </script>

</body>

</html>
=======
<script>
    $.ajax({
        url: "/api/session/register",
        type: "POST",
        contentType: 'application/json',
        data: JSON.stringify({
            email: "2998868901@qq.com",
            nickname: "why",
            avatar: "assets/img/figure/figure1.png",
            gender: 0,
            password: "password"
        }),
        success: function (data, status) {
            alert("测试账号注册成功");
            console.log(data);
        },
        error: function (data, status) {
            alert("测试账号已注册");
            console.log(data);
        }
    });
</script>
>>>>>>> 1545cc422d2dc6fb89d82814fa66dbf6f4dc5796
